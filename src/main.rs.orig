use rust_parallel::parallel::Parallel;
use std::env;
use rust_parallel::core::jobmanager::JobManager;
use rust_parallel::core::interpretor;
use rust_parallel::core::parser;

fn main() {
    #[cfg(debug_assertions)]
    env_logger::init();

    let args: Vec<String> = env::args().collect();

    let mut prg = Parallel::new();
    prg.new_cmd(args[1..args.len()].to_vec());
    prg.start();
}

<<<<<<< HEAD
#[test]
fn test_echo1() {
    // env_logger::init();

    let mut prg = Parallel::new();

    let args: Vec<String> = vec![
        String::from("echo"),
        String::from("Hello"),
        String::from("World"),
    ];
    prg.new_cmd(args);

    prg.start();
}

#[test]
fn test_echo2() {
    // env_logger::init();

    let mut prg = Parallel::new();

    let args: Vec<String> = vec![
        String::from("echo"),
        String::from("-e"),
        String::from("'Hello\nWorld'"),
    ];
    prg.new_cmd(args);

    prg.start();
}

#[test]
fn test_multi_echo() {
    // env_logger::init();

    let mut prg = Parallel::new();

    let args: Vec<String> = vec![
        String::from("echo"),
        String::from("Hello"),
        String::from("World"),
    ];
    prg.new_cmd(args);

    let args: Vec<String> = vec![
        String::from("echo"),
        String::from("-e"),
        String::from("'Hello\nWorld'"),
    ];
    prg.new_cmd(args);

    prg.start();
}

#[test]
fn test_interpretor() {
    let mut jm = JobManager::new();

    let args: Vec<String> = vec![
        String::from("--keep-order"),
        String::from("--dry-run"),
        String::from("-j"),
        String::from("3"),
    ];

    interpretor::interpret(&mut jm, args);

    println!("{}", jm);
}

#[test]
fn test_parser() {
    parser::parse(String::from("paralll --jobs 5 --dry-run echo -i {1}{} ok';' wc -l ::: 1 2 3 ::: 4 5 6"));
}
=======
#[cfg(test)]
mod tests {
    use super::*;
    
    #[test]
    fn lib_test() {
        let _ = env_logger::builder().is_test(true).try_init();

        let mut prg = Parallel::new();

        let args: Vec<String> = vec![
            String::from("echo"),
            String::from("Hello"),
            String::from("World"),
        ];
        prg.new_cmd(args);

        prg.start();
    }
}
>>>>>>> exec
